#!/bin/sh

objectToAppendFilePath="/tmp/$(random_hash).json"

read -p 'Meditate? [true/false] ' meditate
read -p 'Exercise? [true/false] ' exercise
read -p 'Eat well? [true/false] ' eat

printf '{"date": "%s", "habits": {"meditate": { "done": %s }, "exercise": { "done": %s }, "eat": { "done": %s }}}\n' "$(now)" "$meditate" "$exercise" "$eat" |jq >"$objectToAppendFilePath"

newHabitsFile="/tmp/$(random_hash).json"
append-to-json "$objectToAppendFilePath" "$HABITS_STORE" days >"$newHabitsFile"

mv "$newHabitsFile" "$HABITS_STORE"

read -p 'Do you want to update the site now? [y/n] ' updateSite

if [ "$updateSite" = 'y' ]; then
    make -C "$CODE/sites/nperrin.io" scp-habits
fi
